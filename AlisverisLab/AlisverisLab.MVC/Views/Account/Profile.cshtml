@model ProfileModel

<!-- Account Section -->
<section id="account" class="account section">
    <div class="container" data-aos="fade-up" data-aos-delay="100">

        <!-- Mobile Menu Toggle -->
        <div class="mobile-menu d-lg-none mb-4">
            <button class="mobile-menu-toggle" type="button" data-bs-toggle="collapse" data-bs-target="#profileMenu">
                <i class="bi bi-grid"></i>
                <span>Menu</span>
            </button>
        </div>

        <div class="row g-4">
            <!-- Profile Menu -->
            <div class="col-lg-3">
                <div class="profile-menu collapse d-lg-block" id="profileMenu">
                    <!-- User Info - Sadece kullanıcı adı -->
                    <div class="user-info" data-aos="fade-right">
                        <h4>@Model.UserName</h4>
                    </div>

                    <!-- Navigation - Boş bırakıldı -->
                    <ul class="nav flex-column">
                        <!-- Navigation items kaldırıldı -->
                    </ul>
                </div>
            </div>

            <!-- Content Area -->
            <div class="col-lg-9">
                <div class="content-area">
                    <div class="tab-content">
                        <!-- Settings Tab -->
                        <div class="tab-pane fade show active" id="settings">
                            <div class="section-header" data-aos="fade-up">
                                <h2>Account Settings</h2>
                            </div>

                            <div class="settings-content">
                                <!-- Personal Information -->
                                <div class="settings-section" data-aos="fade-up">
                                    <h3>Personal Information</h3>
                                    <form class="php-email-form settings-form" asp-controller="Account" asp-action="ProfileUpdate" method="post">
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <span asp-validation-for="UserName" class="text-danger"></span>
                                                <label class="form-label">UserName</label>
                                                <input asp-for="UserName" type="text" class="form-control">
                                            </div>
                                            <div class="col-md-6">
                                                <span asp-validation-for="Email" class="text-danger"></span>
                                                <label class="form-label">Email</label>
                                                <input asp-for="Email" type="email" class="form-control">
                                            </div>
                                            <div class="col-md-6">
                                                <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                                                <label class="form-label">Phone</label>
                                                <input asp-for="PhoneNumber" type="tel" class="form-control">
                                            </div>
                                            <div class="col-md-6">
                                                <span asp-validation-for="CurrentPassword" class="text-danger"></span>
                                                <label class="form-label">Current Password</label>
                                                <input asp-for="CurrentPassword" type="password" class="form-control">
                                            </div>
                                            <div class="col-md-6">
                                                <span asp-validation-for="Password" class="text-danger"></span>
                                                <label class="form-label">Password</label>
                                                <input asp-for="Password" type="password" class="form-control">
                                            </div>
                                            <div class="col-md-6">
                                                <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                                                <label class="form-label">Confirm Password</label>
                                                <input asp-for="ConfirmPassword" type="password" class="form-control">
                                            </div>
                                        </div>

                                        <div class="form-buttons">
                                            <button type="submit" style="margin-bottom:15px;" class="btn-save">Save Changes</button>
                                        </div>

                                        <div class="loading">Loading</div>
                                        <div class="error-message"></div>
                                        <div class="sent-message">Your changes have been saved successfully!</div>
                                    </form>
                                </div>

                                <!-- Delete Account -->
                                <div class="settings-section danger-zone" data-aos="fade-up" data-aos-delay="300">
                                    <h3 class="text-danger">Delete Account</h3>
                                    <div class="danger-zone-content">
                                        <p>Once you delete your account, there is no going back. Please be certain.</p>
                                        <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteAccountModal">
                                            Delete Account
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Account Modal -->
    <div class="modal fade" id="deleteAccountModal" tabindex="-1" aria-labelledby="deleteAccountModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteAccountModalLabel">Confirm Account Deletion</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete your account? This action cannot be undone.</p>
                    <form id="deleteAccountForm" asp-controller="Account" asp-action="DeleteAccount" method="post">
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Enter your password to confirm:</label>
                            <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" form="deleteAccountForm" class="btn btn-danger">Delete Account</button>
                </div>
            </div>
        </div>
    </div>
</section>

@* @section Scripts {

    <script>
        $(document).ready(function () {
            // Form submission handling
            $('.settings-form').on('submit', function (e) {
                e.preventDefault();

                var form = $(this);
                var loading = form.find('.loading');
                var errorMessage = form.find('.error-message');
                var sentMessage = form.find('.sent-message');

                // Önceki mesajları ve hataları temizle
                loading.show();
                errorMessage.hide().text('');
                sentMessage.hide().text('');
                $('.text-danger').text(''); // Validation hatalarını temizle
                $('.form-control').removeClass('is-invalid'); // Tüm hata border'larını kaldır

                $.ajax({
                    url: form.attr('action'),
                    type: form.attr('method'),
                    data: form.serialize(),
                    success: function (response) {
                        loading.hide();

                        if (response.success) {
                            // BAŞARILI MESAJI (Türkçe/İngilizce)
                            sentMessage.text(response.message || "Your password has been changed successfully!").show();

                            // Tüm şifre alanlarını temizle
                            $('input[type="password"]').val('');

                            // 5 saniye sonra mesajı gizle
                            setTimeout(function () {
                                sentMessage.fadeOut();
                            }, 5000);
                        } else {
                            // HATA MESAJI
                            if (response.errors) {
                                // Field-specific hataları göster
                                $.each(response.errors, function (key, errors) {
                                    var field = $('[data-valmsg-for="' + key + '"]');
                                    var input = $('#' + key);

                                    if (field.length) {
                                        field.text(errors.join(', '));
                                    }
                                    if (input.length) {
                                        input.addClass('is-invalid');
                                        // Şifre alanlarına özel uyarı
                                        if (key.includes('Password')) {
                                            input.next('.text-danger').show();
                                        }
                                    }
                                });
                            }
                            // Genel hata mesajı (Türkçe/İngilizce)
                            errorMessage.html(
                                '<i class="bi bi-exclamation-circle me-2"></i>' +
                                (response.message || "Password change failed. Please check the errors below.")
                            ).show();
                        }
                    },
                    error: function (xhr) {
                        loading.hide();
                        var errorMsg = "An unexpected error occurred";
                        if (xhr.responseJSON && xhr.responseJSON.message) {
                            errorMsg = xhr.responseJSON.message;
                        }
                        errorMessage.html(
                            '<i class="bi bi-exclamation-triangle me-2"></i>' + errorMsg
                        ).show();
                    }
                });
            });

            // Initialize AOS animations
            AOS.init({
                duration: 800,
                easing: 'ease-in-out'
            });

            // Mobile menu toggle
            $('.mobile-menu-toggle').on('click', function () {
                $(this).toggleClass('active');
            });
        });
    </script>
} *@